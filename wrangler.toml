name = "weather-forecast-cdn"
main = "cdn/worker/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# R2 bucket binding for content-addressed storage
[[r2_buckets]]
binding = "BUCKET"
bucket_name = "weather-forecast-cdn"

# Cron triggers for scheduled ingest
[triggers]
crons = ["0 */6 * * *", "0 * * * *"]  # Forecasts every 6 hours; observations hourly on the hour

# Environment variables
[vars]
VITE_CDN_URL = "https://weather-forecast-cdn.graham-cbc.workers.dev"

# Production environment
[env.production]
name = "weather-forecast-cdn-prod"

[[env.production.r2_buckets]]
binding = "BUCKET"
bucket_name = "weather-forecast-cdn-prod"
 
